{% extends "base.html" %}
{% load static %}

{% block title %}E-Waste Navigator Â· Find Responsible Facilities{% endblock %}

{% block content %}
<section class="page-section">
    <div class="layout-container relative grid gap-16 lg:grid-cols-[minmax(0,1fr)_minmax(0,0.9fr)]">
        <span class="ambient-orb top-[-160px] right-[-120px] h-[360px] w-[360px]"></span>
        <div class="relative space-y-10">
            <span class="feature-chip animate-fade-in">
                <i class="fa-solid fa-leaf"></i>
                Circular futures
            </span>
            <h1 class="page-section__title">
                Locate verified e-waste drop-offs, unlock insights, and <span class="text-gradient">earn credits</span> for responsible recycling.
            </h1>
            <p class="page-section__subtitle max-w-2xl">
                E-Waste Navigator connects households and businesses with certified collection partners, serving up quick micro-learning moments along the way.
            </p>
            <div class="flex flex-wrap items-center gap-3">
                <a href="{% url 'facilities:facility_list' %}" class="primary-btn">
                    <i class="fa-solid fa-compass"></i>
                    Discover facilities
                </a>
                <a href="{% url 'devices:submit' %}" class="secondary-btn">
                    <i class="fa-solid fa-wand-magic-sparkles"></i>
                    Submit a device
                </a>
            </div>
            <dl class="grid gap-4 sm:grid-cols-3">
                <div class="stat-card">
                    <dt class="stat-label"><i class="fa-solid fa-industry mr-2"></i>Network facilities</dt>
                    <dd class="stat-value">{{ total_facilities }}</dd>
                </div>
                <div class="stat-card">
                    <dt class="stat-label"><i class="fa-solid fa-radiation mr-2"></i>Hazardous components</dt>
                    <dd class="stat-value">{{ total_components }}</dd>
                </div>
                <div class="stat-card">
                    <dt class="stat-label"><i class="fa-solid fa-microchip mr-2"></i>Mapped devices</dt>
                    <dd class="stat-value">{{ total_device_models }}</dd>
                </div>
            </dl>
        </div>
        <div class="relative">
            <div class="glass-card">
                <div class="flex items-center justify-between">
                    <div>
                        <span class="chip-badge"><i class="fa-solid fa-satellite-dish"></i>Smart search</span>
                        <h2 class="mt-4 text-2xl font-semibold text-slate-900 dark:text-white">Find a recycling partner</h2>
                        <p class="mt-2 text-sm text-slate-600 dark:text-slate-400">Filter by location or certified services. Results update instantly.</p>
                    </div>
                    <span class="inline-flex h-12 w-12 items-center justify-center rounded-2xl bg-sky-500/15 text-sky-600 dark:text-sky-300">
                        <i class="fa-solid fa-map-location-dot"></i>
                    </span>
                </div>
                <form action="{% url 'facilities:facility_list' %}" method="get" class="mt-8 space-y-5">
                    <div>
                        <label for="id_query" class="inline-flex items-center gap-2 text-sm font-medium text-slate-600 dark:text-slate-200">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            Location or facility
                        </label>
                        <div class="input-shell mt-2">
                            <span class="input-shell__icon"><i class="fa-solid fa-location-dot"></i></span>
                            {{ search_form.query }}
                        </div>
                    </div>
                    <div>
                        <label for="id_service" class="inline-flex items-center gap-2 text-sm font-medium text-slate-600 dark:text-slate-200">
                            <i class="fa-solid fa-filter"></i>
                            Service filter
                        </label>
                        <div class="input-shell mt-2">
                            <span class="input-shell__icon"><i class="fa-solid fa-screwdriver-wrench"></i></span>
                            <span class="input-shell__chevron"><i class="fa-solid fa-chevron-down"></i></span>
                            {{ search_form.service }}
                        </div>
                    </div>
                    <button type="submit" class="primary-btn w-full">
                        <i class="fa-solid fa-compass"></i>
                        Discover facilities near me
                    </button>
                </form>
            </div>
        </div>
    </div>
</section>

<section class="page-section">
    <div class="layout-container flex flex-col gap-14 lg:flex-row">
        <div class="flex-1 space-y-6">
            <span class="feature-chip"><i class="fa-solid fa-signal"></i>Community favorites</span>
            <h2 class="page-section__title text-3xl sm:text-4xl">Trending collection partners</h2>
            <p class="page-section__subtitle">These facilities earn high marks for precise sorting, transparent downstream processing, and quick credit verification.</p>
            <div class="grid gap-6 md:grid-cols-2">
                {% for facility in featured_facilities %}
                    <article class="grid-card">
                        <div class="flex items-start justify-between gap-3">
                            <div>
                                <p class="chip-badge mb-3"><i class="fa-solid fa-star"></i>Featured</p>
                                <h3 class="text-xl font-semibold text-slate-900 dark:text-white">{{ facility.name }}</h3>
                                <p class="mt-1 text-sm text-slate-500 dark:text-slate-400">{{ facility.tagline|default:facility.city }}</p>
                            </div>
                            <span class="inline-flex h-12 w-12 items-center justify-center rounded-2xl bg-emerald-500/15 text-emerald-500 dark:text-emerald-300">
                                <i class="fa-solid fa-building"></i>
                            </span>
                        </div>
                        <dl class="mt-5 space-y-2 text-sm text-slate-600 dark:text-slate-400">
                            <div class="flex items-center justify-between">
                                <dt><i class="fa-solid fa-location-crosshairs mr-2 text-sky-500"></i>Location</dt>
                                <dd class="font-medium text-slate-700 dark:text-slate-200">{{ facility.city }}, {{ facility.state_province }}</dd>
                            </div>
                            <div class="flex items-center justify-between">
                                <dt><i class="fa-solid fa-screwdriver-wrench mr-2 text-emerald-500"></i>Services</dt>
                                <dd class="font-medium text-slate-700 dark:text-slate-200">{{ facility.services.all|join:", " }}</dd>
                            </div>
                        </dl>
                        <a href="{% url 'facilities:facility_detail' facility.slug %}" class="mt-6 inline-flex items-center text-sm font-semibold text-sky-600 hover:text-sky-500 dark:text-sky-300 dark:hover:text-sky-200">
                            View facility profile
                            <i class="fa-solid fa-arrow-up-right-from-square ml-2 text-xs"></i>
                        </a>
                    </article>
                {% empty %}
                    <p class="text-sm text-slate-500 dark:text-slate-500">Add your first verified facility to highlight it here.</p>
                {% endfor %}
            </div>
        </div>
        <aside class="w-full max-w-md space-y-6">
            <div class="glass-card">
                <span class="chip-badge"><i class="fa-solid fa-lightbulb"></i>Learn & earn</span>
                <h2 class="mt-4 text-2xl font-semibold text-slate-900 dark:text-white">Micro-learning boosts confidence</h2>
                <p class="mt-3 text-sm text-slate-600 dark:text-slate-400">Prep households and teams before arriving on-site with concise modules curated by sustainability experts.</p>
                <ul class="mt-6 space-y-4">
                    {% for module in featured_modules %}
                        <li class="rounded-2xl border border-slate-200/70 bg-white/70 p-4 shadow-sm transition hover:-translate-y-[2px] hover:shadow-lg dark:border-slate-800/60 dark:bg-slate-900/60">
                            <p class="card-meta mb-1 text-[11px] text-slate-500 dark:text-slate-500">{{ module.get_module_type_display }}</p>
                            <a href="#" class="block text-base font-semibold text-slate-900 hover:text-sky-600 dark:text-white dark:hover:text-sky-300">{{ module.title }}</a>
                            <p class="mt-2 text-sm text-slate-600 line-clamp-3 dark:text-slate-400">{{ module.summary }}</p>
                        </li>
                    {% empty %}
                        <li class="text-sm text-slate-500 dark:text-slate-500">Curate modules to inspire confident recycling.</li>
                    {% endfor %}
                </ul>
            </div>
        </aside>
    </div>
</section>

<section class="page-section page-section--muted">
    <div class="layout-container">
        <span class="feature-chip"><i class="fa-solid fa-route"></i>How it works</span>
        <h2 class="mt-6 text-3xl font-semibold text-slate-900 sm:text-4xl dark:text-white">A guided path from input to impact</h2>
        <div class="mt-10 grid gap-6 lg:grid-cols-3">
            <article class="subtle-card hover:-translate-y-[2px] hover:shadow-lg dark:hover:border-sky-400/40">
                <span class="chip-badge mb-4"><i class="fa-solid fa-1"></i>Step one</span>
                <h3 class="card-heading">Share device details</h3>
                <p class="card-body mt-3">Pick a catalogued model or add your own. AI-powered estimates highlight valuable materials and credit expectations.</p>
                <a href="{% url 'devices:submit' %}" class="mt-5 inline-flex items-center text-sm font-semibold text-sky-600 hover:text-sky-500 dark:text-sky-300 dark:hover:text-sky-200">
                    Start a submission
                    <i class="fa-solid fa-arrow-right ml-2 text-xs"></i>
                </a>
            </article>
            <article class="subtle-card hover:-translate-y-[2px] hover:shadow-lg dark:hover:border-sky-400/40">
                <span class="chip-badge mb-4"><i class="fa-solid fa-2"></i>Step two</span>
                <h3 class="card-heading">Drop off responsibly</h3>
                <p class="card-body mt-3">Receive packaging checklists, data wiping reminders, and facility-specific instructions that streamline intake.</p>
            </article>
            <article class="subtle-card hover:-translate-y-[2px] hover:shadow-lg dark:hover:border-sky-400/40">
                <span class="chip-badge mb-4"><i class="fa-solid fa-3"></i>Step three</span>
                <h3 class="card-heading">Earn verified credits</h3>
                <p class="card-body mt-3">Track recovery performance, unlock incentives, and reinvest rewards into community-driven sustainability initiatives.</p>
            </article>
        </div>
    </div>
</section>
{% endblock %}
